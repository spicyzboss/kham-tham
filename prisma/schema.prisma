generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

datasource db {
  provider             = "mysql"
  url                  = env("DATABASE_URL")
  referentialIntegrity = "prisma"
}

model User {
  id        String    @id @default(uuid())
  username  String    @unique
  password  String
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  Room      Room[]

  @@map("users")
}

model Player {
  id            String @id @default(uuid())
  name          String
  correctAnswer Int
  room          Room   @relation(fields: [roomId], references: [id])
  roomId        Int

  @@map("players")
}

model Room {
  id        Int         @id @default(autoincrement())
  code      String      @unique
  user      User        @relation(fields: [userId], references: [id])
  userId    String
  name      String
  mode      ModeRoom
  minScore  Float
  status    StatusRoom
  question  Question[]
  statistic Statistic[]
  player    Player[]

  @@map("rooms")
}

enum StatusRoom {
  CLOSING
  WAITING
  PLAYING
}

enum ModeRoom {
  competitive
  cooperative
}

model Question {
  id                 Int         @id @default(autoincrement())
  room               Room        @relation(fields: [roomId], references: [id])
  index              Int
  roomId             Int
  description        String
  choice_1           String
  choice_2           String
  choice_3           String
  choice_4           String
  timeShowQuestion   Float
  timeAnswerQuestion Float
  Statistic          Statistic[]

  @@map("questions")
}

model Statistic {
  id                  Int      @id @default(autoincrement())
  room                Room     @relation(fields: [roomId], references: [id])
  roomId              Int
  question            Question @relation(fields: [questionId], references: [id])
  questionId          Int
  amountAllAnswer     Int
  amountCorrectAnswer Int

  @@map("statistics")
}
